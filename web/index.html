<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE.ICU - CVE Analysis Dashboard</title>
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="static/images/logo.png">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="static/css/style.css">
    
    <!-- Meta tags for SEO -->
    <meta name="description" content="CVE.ICU provides comprehensive analysis and visualization of Common Vulnerabilities and Exposures (CVE) data from 1999 to present.">
    <meta name="keywords" content="CVE, vulnerabilities, security, analysis, dashboard, cybersecurity">
    <meta name="author" content="CVE.ICU">
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="CVE.ICU - CVE Analysis Dashboard">
    <meta property="og:description" content="Comprehensive CVE analysis and visualization from 1999 to present">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cve.icu">
    <meta property="og:image" content="https://cve.icu/static/images/logo.png">
</head>
<body>
    <!-- Header and Navigation -->
    <header class="header">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <img src="static/images/logo.png" alt="CVE.ICU Logo">
                CVE.ICU
            </a>
            
            <nav class="nav">
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="years.html">Years</a></li>
                    <li><a href="cna.html">CNA</a></li>
                    <li><a href="cpe.html">CPE</a></li>
                    <li><a href="cwe.html">CWE</a></li>
                    <li><a href="cvss.html">CVSS</a></li>
                    <li><a href="growth.html">Growth</a></li>
                    <li><a href="calendar.html">Calendar</a></li>
                </ul>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        
<!-- Hero Section -->
<div class="text-center mb-5">
    <h1 class="mb-3">CVE.ICU</h1>
    <p class="text-muted">Advanced vulnerability intelligence platform delivering comprehensive CVE analytics from 1999 to 2025</p>
</div>

<!-- Statistics Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number" id="cves-this-year">Loading...</div>
        <div class="stat-label">CVEs This Year</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="avg-cves-per-day">Loading...</div>
        <div class="stat-label">Avg CVEs/Day</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="growth-rate">Loading...</div>
        <div class="stat-label">YOY Growth</div>
        <div class="stat-detail" id="growth-detail">Loading...</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="total-cves">Loading...</div>
        <div class="stat-label">Total CVEs</div>
    </div>
</div>

<!-- CVEs by Year Chart -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title mb-0">CVEs Published by Year</h3>
    </div>
    <div class="card-body">
        <div class="chart-container">
            <canvas id="cvesByYearChart"></canvas>
        </div>
    </div>
</div>

<!-- Welcome Section -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title mb-0">About CVE.ICU</h3>
    </div>
    <div class="card-body">
        <p class="mb-4">CVE.ICU provides comprehensive vulnerability intelligence through advanced analytics and visualization of Common Vulnerabilities and Exposures (CVE) data spanning 27 years of cybersecurity history from 1999 to 2025.</p>
        
        <div class="row">
            <div class="col-md-6">
                <h4>Platform Capabilities</h4>
                <ul class="mb-4">
                    <li><strong>Comprehensive Coverage:</strong> Complete historical CVE dataset with continuous updates</li>
                    <li><strong>Advanced Analytics:</strong> Interactive dashboards with dynamic data visualization</li>
                    <li><strong>Real-Time Intelligence:</strong> Automated data refresh every 6 hours</li>
                    <li><strong>Scalable Architecture:</strong> Self-expanding system accommodating future data</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h4>Data Infrastructure</h4>
                <ul class="mb-4">
                    <li><strong>Primary Source:</strong> NIST National Vulnerability Database (NVD)</li>
                    <li><strong>Processing Pipeline:</strong> Automated ingestion and normalization</li>
                    <li><strong>Historical Repository:</strong> Complete vulnerability records archive</li>
                    <li><strong>Update Frequency:</strong> Continuous 6-hour synchronization cycle</li>
                </ul>
            </div>
        </div>
        
        <div class="text-center">
            <div class="alert alert-info" style="background-color: rgba(13, 110, 253, 0.1); border: 1px solid rgba(13, 110, 253, 0.2); border-radius: 0.5rem; padding: 1rem; margin-top: 1.5rem;">
                <p class="mb-0"><strong>Automated Intelligence Platform:</strong> CVE.ICU operates on a fully automated infrastructure that ensures continuous data availability and seamless expansion. The system is engineered to automatically incorporate new vulnerability data as it becomes available, requiring zero manual intervention for ongoing operations.</p>
            </div>
        </div>
    </div>
</div>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 CVE.ICU | 
               <a href="https://github.com/yourusername/cve.icu" target="_blank">GitHub</a> | 
               Data updated every 6 hours | 
               CVE coverage: 1999-2025
            </p>
            <p class="text-muted">
                Built with ❤️ for the cybersecurity community | 
                <a href="https://cnascorecard.org" target="_blank">CNA Scorecard</a> | 
                <a href="https://cvceforecast.org" target="_blank">CVE Forecast</a>
            </p>
        </div>
    </footer>

    <!-- Chart.js Library (UMD version) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Wait for Chart.js to load before configuring
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Chart !== 'undefined') {
                // Global configuration for Chart.js with design system
                Chart.defaults.responsive = true;
                Chart.defaults.maintainAspectRatio = false;
                Chart.defaults.plugins.legend.position = 'top';
                Chart.defaults.plugins.legend.labels.usePointStyle = true;
                Chart.defaults.plugins.legend.labels.padding = 20;
                Chart.defaults.plugins.legend.labels.font = {
                    family: 'Inter, sans-serif',
                    size: 12,
                    weight: '500'
                };
                Chart.defaults.plugins.title.display = true;
                Chart.defaults.plugins.title.font = {
                    family: 'Inter, sans-serif',
                    size: 16,
                    weight: '600'
                };
                Chart.defaults.plugins.title.color = '#212529';
                Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(255, 255, 255, 0.95)';
                Chart.defaults.plugins.tooltip.titleColor = '#212529';
                Chart.defaults.plugins.tooltip.bodyColor = '#6c757d';
                Chart.defaults.plugins.tooltip.borderColor = '#dee2e6';
                Chart.defaults.plugins.tooltip.borderWidth = 1;
                Chart.defaults.plugins.tooltip.cornerRadius = 8;
                Chart.defaults.plugins.tooltip.titleFont = {
                    family: 'Inter, sans-serif',
                    size: 13,
                    weight: '600'
                };
                Chart.defaults.plugins.tooltip.bodyFont = {
                    family: 'Inter, sans-serif',
                    size: 12,
                    weight: '400'
                };
                // Chart.js v4 scale configuration
                Chart.defaults.elements.point.backgroundColor = '#2196f3';
                Chart.defaults.elements.point.borderColor = '#2196f3';
                Chart.defaults.elements.line.borderColor = '#2196f3';
                Chart.defaults.elements.bar.backgroundColor = '#2196f3';
                
                // Note: Scale-specific defaults are set per chart type in Chart.js v4
                // Global scale defaults are handled differently
            }
            
            // Add active class to current page navigation link
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            const navLinks = document.querySelectorAll('.nav-menu a');
            
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href === currentPage || (currentPage === '' && href === 'index.html')) {
                    link.classList.add('active');
                }
            });
        });
        
        // Enhanced Color palette for consistent styling (Light Blue to Grey)
        window.CVE_COLORS = window.CVE_COLORS || {
            primary: '#2196f3',
            secondary: '#64b5f6', 
            success: '#81c784',
            warning: '#ffb74d',
            danger: '#f06292',
            light: '#f8f9fa',
            dark: '#212529',
            
            // Light Blue to Grey Visualization Palette
            vizColors: [
                '#e3f2fd', // Very light blue
                '#bbdefb', // Light blue
                '#90caf9', // Medium light blue
                '#64b5f6', // Medium blue
                '#42a5f5', // Blue
                '#2196f3', // Primary blue
                '#1e88e5', // Darker blue
                '#1976d2', // Dark blue
                '#9e9e9e', // Medium grey
                '#757575'  // Dark grey
            ],
            
            // Chart-specific colors
            chartColors: [
                '#2196f3', // Primary blue
                '#64b5f6', // Secondary blue
                '#90caf9', // Tertiary blue
                '#bbdefb', // Quaternary blue
                '#81c784', // Accent green
                '#ffb74d', // Accent orange
                '#f06292', // Accent pink
                '#e0e0e0', // Light grey
                '#9e9e9e', // Medium grey
                '#616161'  // Dark grey
            ],
            
            // Gradient colors for backgrounds
            gradients: {
                primary: 'linear-gradient(135deg, #e3f2fd, #bbdefb)',
                secondary: 'linear-gradient(135deg, #bbdefb, #90caf9)',
                tertiary: 'linear-gradient(135deg, #90caf9, #64b5f6)'
            }
        };
        
        // Enhanced utility function to generate colors for charts
        function getChartColors(count, type = 'chart') {
            const colors = [];
            const palette = type === 'viz' ? CVE_COLORS.vizColors : CVE_COLORS.chartColors;
            
            for (let i = 0; i < count; i++) {
                colors.push(palette[i % palette.length]);
            }
            return colors;
        }
        
        // Generate light blue to grey gradient colors
        function getGradientColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                const ratio = i / Math.max(count - 1, 1);
                // Interpolate between light blue and grey
                const r = Math.round(227 + (158 - 227) * ratio); // e3 to 9e
                const g = Math.round(242 + (158 - 242) * ratio); // f2 to 9e
                const b = Math.round(253 + (158 - 253) * ratio); // fd to 9e
                colors.push(`rgb(${r}, ${g}, ${b})`);
            }
            return colors;
        }
        
        // Get color with opacity
        function getColorWithOpacity(color, opacity = 0.8) {
            if (color.startsWith('#')) {
                const r = parseInt(color.slice(1, 3), 16);
                const g = parseInt(color.slice(3, 5), 16);
                const b = parseInt(color.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${opacity})`;
            }
            return color;
        }
        
        // Utility function to format numbers
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }
        
        // Utility function to show loading state
        function showLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = '<div class="loading"><div class="spinner"></div>Loading data...</div>';
            }
        }
        
        // Utility function to hide loading state
        function hideLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                const loading = container.querySelector('.loading');
                if (loading) {
                    loading.remove();
                }
            }
        }
        
        // Get current year for dynamic functionality
        const CURRENT_YEAR = new Date().getFullYear();
        const AVAILABLE_YEARS = [];
        for (let year = 1999; year <= CURRENT_YEAR; year++) {
            AVAILABLE_YEARS.push(year);
        }
    </script>
    
    
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Wait for Chart.js and CVE_COLORS to be available
    if (typeof Chart === 'undefined' || typeof window.CVE_COLORS === 'undefined') {
        console.error('Chart.js or CVE_COLORS not loaded');
        return;
    }
    
    // Initialize CVEs by Year Chart
    const ctx = document.getElementById('cvesByYearChart');
    if (ctx) {
        // Sample data - this would be populated by the Python backend
        const yearlyData = {
            labels: [],
            datasets: [{
                label: 'CVEs Published',
                data: [],
                backgroundColor: 'rgba(13, 110, 253, 0.1)',
                borderColor: window.CVE_COLORS.primary,
                borderWidth: 2,
                fill: true,
                tension: 0.1
            }]
        };
        
        // Load actual CVE data from JSON files
        const currentYear = new Date().getFullYear();
        const loadPromises = [];
        
        // Generate years from 1999 to current year and load data
        for (let year = 1999; year <= currentYear; year++) {
            yearlyData.labels.push(year.toString());
            
            // Load actual CVE data for each year
            const promise = fetch(`data/cve_${year}.json`)
                .then(response => {
                    if (!response.ok) {
                        console.warn(`No data found for year ${year}`);
                        return { total_cves: 0 };
                    }
                    return response.json();
                })
                .then(data => {
                    return { year: year, count: data.total_cves || 0 };
                })
                .catch(error => {
                    console.warn(`Error loading data for year ${year}:`, error);
                    return { year: year, count: 0 };
                });
            
            loadPromises.push(promise);
        }
        
        // Wait for all data to load, then create the chart and update stats
        Promise.all(loadPromises).then(results => {
            // Sort results by year to ensure correct order
            results.sort((a, b) => a.year - b.year);
            
            // Extract the CVE counts in the correct order
            yearlyData.datasets[0].data = results.map(result => result.count);
            
            // Calculate and update statistics
            updateStatistics(results);
            
            // Create the chart with real data
            createChart();
        }).catch(error => {
            console.error('Error loading CVE data:', error);
            // Fallback: create chart with empty data and show error in stats
            updateStatisticsError();
            createChart();
        });
        
        function updateStatistics(results) {
            try {
                // Calculate total CVEs
                const totalCves = results.reduce((sum, result) => sum + result.count, 0);
                
                // Get current year data
                const currentYear = new Date().getFullYear();
                const currentYearData = results.find(r => r.year === currentYear);
                const cvesThisYear = currentYearData ? currentYearData.count : 0;
                
                // Calculate average CVEs per day for current year
                const dayOfYear = Math.floor((new Date() - new Date(currentYear, 0, 0)) / (1000 * 60 * 60 * 24));
                const avgCvesPerDay = cvesThisYear > 0 && dayOfYear > 0 ? (cvesThisYear / dayOfYear).toFixed(1) : '0';
                
                // Calculate date-accurate YOY growth rate
                // We need to compare CVEs published by the same date in both years
                // For now, we'll estimate based on the current day of year
                const previousYearData = results.find(r => r.year === currentYear - 1);
                const previousYearFullCount = previousYearData ? previousYearData.count : 0;
                
                // Estimate what the previous year count would be by this same date
                // Assume roughly even distribution throughout the year for estimation
                // (reuse dayOfYear from above)
                const yearProgress = dayOfYear / 365; // Percentage of year completed
                const estimatedPreviousYearByDate = Math.round(previousYearFullCount * yearProgress);
                
                let growthRate = 'N/A';
                let growthDetail = 'Calculating...';
                
                if (estimatedPreviousYearByDate > 0 && cvesThisYear > 0) {
                    const growth = ((cvesThisYear - estimatedPreviousYearByDate) / estimatedPreviousYearByDate) * 100;
                    growthRate = (growth >= 0 ? '+' : '') + growth.toFixed(1) + '%';
                    
                    // Create detail text showing the comparison
                    const currentDate = new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    growthDetail = `${cvesThisYear.toLocaleString()} vs ${estimatedPreviousYearByDate.toLocaleString()} (by ${currentDate})`;
                }
                
                // Update the DOM elements
                document.getElementById('cves-this-year').textContent = cvesThisYear.toLocaleString();
                document.getElementById('avg-cves-per-day').textContent = avgCvesPerDay;
                document.getElementById('growth-rate').textContent = growthRate;
                document.getElementById('growth-detail').textContent = growthDetail;
                document.getElementById('total-cves').textContent = totalCves.toLocaleString();
                
            } catch (error) {
                console.error('Error calculating statistics:', error);
                updateStatisticsError();
            }
        }
        
        function updateStatisticsError() {
            document.getElementById('cves-this-year').textContent = 'Error';
            document.getElementById('avg-cves-per-day').textContent = 'Error';
            document.getElementById('growth-rate').textContent = 'Error';
            document.getElementById('growth-detail').textContent = 'Error';
            document.getElementById('total-cves').textContent = 'Error';
        }
        
        function createChart() {
        
            new Chart(ctx, {
                type: 'line',
                data: yearlyData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'CVE Publications by Year (1999-' + currentYear + ')'
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'CVEs: ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'CVE Publications'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    elements: {
                        line: {
                            tension: 0.1,
                            borderWidth: 2
                        },
                        point: {
                            radius: 4,
                            hoverRadius: 6
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }
    }
});
</script>

</body>
</html>