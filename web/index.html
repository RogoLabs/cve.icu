<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE.ICU - CVE Analysis Dashboard</title>
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="static/images/logo.png">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="static/css/style.css">
    
    <!-- Meta tags for SEO -->
    <meta name="description" content="CVE.ICU provides comprehensive analysis and visualization of Common Vulnerabilities and Exposures (CVE) data from 1999 to present.">
    <meta name="keywords" content="CVE, vulnerabilities, security, analysis, dashboard, cybersecurity">
    <meta name="author" content="CVE.ICU">
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="CVE.ICU - CVE Analysis Dashboard">
    <meta property="og:description" content="Comprehensive CVE analysis and visualization from 1999 to present">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cve.icu">
    <meta property="og:image" content="https://cve.icu/static/images/logo.png">
</head>
<body>
    <!-- Header and Navigation -->
    <header class="header">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <img src="static/images/logo.png" alt="CVE.ICU Logo">
                CVE.ICU
            </a>
            
            <nav class="nav">
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="years.html">Years</a></li>
                    <li><a href="cna.html">CNA</a></li>
                    <li><a href="cpe.html">CPE</a></li>
                    <li><a href="cwe.html">CWE</a></li>
                    <li><a href="cvss.html">CVSS</a></li>
                    <li><a href="growth.html">Growth</a></li>
                    <li><a href="calendar.html">Calendar</a></li>
                </ul>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        
<!-- Hero Section -->
<div class="text-center mb-5">
    <h1 class="mb-3">CVE.ICU</h1>
    <p class="text-muted">Advanced vulnerability intelligence platform delivering comprehensive CVE analytics from 1999 to 2025</p>
</div>

<!-- Statistics Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number" id="cves-this-year">Loading...</div>
        <div class="stat-label">CVEs This Year</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="avg-cves-per-day">Loading...</div>
        <div class="stat-label">Avg CVEs/Day</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="growth-rate">Loading...</div>
        <div class="stat-label">YOY Growth</div>
        <div class="stat-detail" id="growth-detail">Loading...</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="total-cves">Loading...</div>
        <div class="stat-label">Total CVEs</div>
    </div>
</div>

<!-- Featured Visualization: CVEs by Year -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title mb-0">üìä CVE Publications by Year</h3>
        <small class="text-muted">Historical trend of vulnerability disclosures from 1999 to present</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 400px;">
            <canvas id="cvesByYearChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <small class="text-muted">Interactive visualization showing annual CVE publication trends</small>
        </div>
    </div>
</div>

<!-- Dashboard Previews -->

<!-- Growth Preview -->
<div class="card mb-4">
    <div class="card-header">
        <h4 class="card-title mb-0">üìà Growth</h4>
        <small class="text-muted">Year-over-year CVE publication trends and growth analysis</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 250px;">
            <canvas id="growthPreviewChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <a href="growth.html" class="btn btn-primary btn-sm">View Full Dashboard ‚Üí</a>
        </div>
    </div>
</div>

<!-- CVSS Preview -->
<div class="card mb-4">
    <div class="card-header">
        <h4 class="card-title mb-0">üéØ CVSS</h4>
        <small class="text-muted">Vulnerability severity scoring analysis across all CVSS versions</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 250px;">
            <canvas id="cvssPreviewChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <a href="cvss.html" class="btn btn-primary btn-sm">View Full Dashboard ‚Üí</a>
        </div>
    </div>
</div>

<!-- CWE Preview -->
<div class="card mb-4">
    <div class="card-header">
        <h4 class="card-title mb-0">üîç CWE</h4>
        <small class="text-muted">Common Weakness Enumeration patterns and vulnerability types</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 250px;">
            <canvas id="cwePreviewChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <a href="cwe.html" class="btn btn-primary btn-sm">View Full Dashboard ‚Üí</a>
        </div>
    </div>
</div>

<!-- CNA Preview -->
<div class="card mb-4">
    <div class="card-header">
        <h4 class="card-title mb-0">üè¢ CNA</h4>
        <small class="text-muted">CVE Numbering Authority activity and organizational analysis</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 250px;">
            <canvas id="cnaPreviewChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <a href="cna.html" class="btn btn-primary btn-sm">View Full Dashboard ‚Üí</a>
        </div>
    </div>
</div>

<!-- CPE Preview -->
<div class="card mb-4">
    <div class="card-header">
        <h4 class="card-title mb-0">üíª CPE</h4>
        <small class="text-muted">Common Platform Enumeration and affected technology analysis</small>
    </div>
    <div class="card-body">
        <div class="chart-container" style="height: 250px;">
            <canvas id="cpePreviewChart"></canvas>
        </div>
        <div class="text-center mt-3">
            <a href="cpe.html" class="btn btn-primary btn-sm">View Full Dashboard ‚Üí</a>
        </div>
    </div>
</div>

<!-- About Section -->
<div class="card mt-5">
    <div class="card-header">
        <h3 class="card-title mb-0">About CVE.ICU</h3>
    </div>
    <div class="card-body">
        <p class="mb-4">CVE.ICU provides comprehensive vulnerability intelligence through advanced analytics and visualization of Common Vulnerabilities and Exposures (CVE) data spanning 27 years of cybersecurity history from 1999 to 2025.</p>
        
        <div class="row">
            <div class="col-md-6">
                <h4>Platform Capabilities</h4>
                <ul class="mb-4">
                    <li><strong>Comprehensive Coverage:</strong> Complete historical CVE dataset with continuous updates</li>
                    <li><strong>Advanced Analytics:</strong> Interactive dashboards with dynamic data visualization</li>
                    <li><strong>Real-Time Intelligence:</strong> Automated data refresh every 6 hours</li>
                    <li><strong>Scalable Architecture:</strong> Self-expanding system accommodating future data</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h4>Data Infrastructure</h4>
                <ul class="mb-4">
                    <li><strong>Primary Source:</strong> NIST National Vulnerability Database (NVD)</li>
                    <li><strong>Processing Pipeline:</strong> Automated ingestion and normalization</li>
                    <li><strong>Historical Repository:</strong> Complete vulnerability records archive</li>
                    <li><strong>Update Frequency:</strong> Continuous 6-hour synchronization cycle</li>
                </ul>
            </div>
        </div>
        
        <div class="text-center">
            <div class="alert alert-info" style="background-color: rgba(13, 110, 253, 0.1); border: 1px solid rgba(13, 110, 253, 0.2); border-radius: 0.5rem; padding: 1rem; margin-top: 1.5rem;">
                <p class="mb-0"><strong>Automated Intelligence Platform:</strong> CVE.ICU operates on a fully automated infrastructure that ensures continuous data availability and seamless expansion. The system is engineered to automatically incorporate new vulnerability data as it becomes available, requiring zero manual intervention for ongoing operations.</p>
            </div>
        </div>
    </div>
</div>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div style="display: flex; flex-wrap: wrap; gap: 2rem; justify-content: space-between;">
                <div style="flex: 1; min-width: 200px;">
                    <p class="mb-1"><strong>Data Sources:</strong></p>
                    <p class="text-muted small mb-0">
                        <a href="https://nvd.nist.gov/" target="_blank" class="text-decoration-none">National Vulnerability Database (NVD)</a><br>
                        <a href="https://cve.org/" target="_blank" class="text-decoration-none">CVE Program</a><br>
                        Last updated: <span id="lastUpdated">Loading...</span>
                    </p>
                </div>
                <div style="flex: 1; min-width: 200px; text-align: right;">
                    <p class="mb-1"><strong>Community Projects:</strong></p>
                    <p class="text-muted small mb-0">
                        <a href="https://cnascorecard.org" target="_blank" class="text-decoration-none">CNA Scorecard</a><br>
                        <a href="https://cvceforecast.org" target="_blank" class="text-decoration-none">CVE Forecast</a><br>
                        <a href="https://github.com/yourusername/cve.icu" target="_blank" class="text-decoration-none">GitHub Repository</a>
                    </p>
                </div>
            </div>
            <hr class="my-2">
            <div class="text-center">
                <small class="text-muted">
                    &copy; 2025 CVE.ICU ‚Ä¢ Built by <a href="https://rogolabs.net" target="_blank" class="text-decoration-none">RogoLabs</a><br>
                    Data updated every 6 hours ‚Ä¢ CVE coverage: 1999-2025
                </small>
            </div>
        </div>
    </footer>

    <!-- Chart.js Library (UMD version) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Wait for Chart.js to load before configuring
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Chart !== 'undefined') {
                // Global configuration for Chart.js with design system
                Chart.defaults.responsive = true;
                Chart.defaults.maintainAspectRatio = false;
                Chart.defaults.plugins.legend.position = 'top';
                Chart.defaults.plugins.legend.labels.usePointStyle = true;
                Chart.defaults.plugins.legend.labels.padding = 20;
                Chart.defaults.plugins.legend.labels.font = {
                    family: 'Inter, sans-serif',
                    size: 12,
                    weight: '500'
                };
                Chart.defaults.plugins.title.display = true;
                Chart.defaults.plugins.title.font = {
                    family: 'Inter, sans-serif',
                    size: 16,
                    weight: '600'
                };
                Chart.defaults.plugins.title.color = '#212529';
                Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(255, 255, 255, 0.95)';
                Chart.defaults.plugins.tooltip.titleColor = '#212529';
                Chart.defaults.plugins.tooltip.bodyColor = '#6c757d';
                Chart.defaults.plugins.tooltip.borderColor = '#dee2e6';
                Chart.defaults.plugins.tooltip.borderWidth = 1;
                Chart.defaults.plugins.tooltip.cornerRadius = 8;
                Chart.defaults.plugins.tooltip.titleFont = {
                    family: 'Inter, sans-serif',
                    size: 13,
                    weight: '600'
                };
                Chart.defaults.plugins.tooltip.bodyFont = {
                    family: 'Inter, sans-serif',
                    size: 12,
                    weight: '400'
                };
                // Chart.js v4 scale configuration
                Chart.defaults.elements.point.backgroundColor = '#2196f3';
                Chart.defaults.elements.point.borderColor = '#2196f3';
                Chart.defaults.elements.line.borderColor = '#2196f3';
                Chart.defaults.elements.bar.backgroundColor = '#2196f3';
                
                // Note: Scale-specific defaults are set per chart type in Chart.js v4
                // Global scale defaults are handled differently
            }
            
            // Add active class to current page navigation link
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            const navLinks = document.querySelectorAll('.nav-menu a');
            
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href === currentPage || (currentPage === '' && href === 'index.html')) {
                    link.classList.add('active');
                }
            });
        });
        
        // Enhanced Color palette for consistent styling (Light Blue to Grey)
        window.CVE_COLORS = window.CVE_COLORS || {
            primary: '#2196f3',
            secondary: '#64b5f6', 
            success: '#81c784',
            warning: '#ffb74d',
            danger: '#f06292',
            light: '#f8f9fa',
            dark: '#212529',
            
            // Light Blue to Grey Visualization Palette
            vizColors: [
                '#e3f2fd', // Very light blue
                '#bbdefb', // Light blue
                '#90caf9', // Medium light blue
                '#64b5f6', // Medium blue
                '#42a5f5', // Blue
                '#2196f3', // Primary blue
                '#1e88e5', // Darker blue
                '#1976d2', // Dark blue
                '#9e9e9e', // Medium grey
                '#757575'  // Dark grey
            ],
            
            // Chart-specific colors
            chartColors: [
                '#2196f3', // Primary blue
                '#64b5f6', // Secondary blue
                '#90caf9', // Tertiary blue
                '#bbdefb', // Quaternary blue
                '#81c784', // Accent green
                '#ffb74d', // Accent orange
                '#f06292', // Accent pink
                '#e0e0e0', // Light grey
                '#9e9e9e', // Medium grey
                '#616161'  // Dark grey
            ],
            
            // Gradient colors for backgrounds
            gradients: {
                primary: 'linear-gradient(135deg, #e3f2fd, #bbdefb)',
                secondary: 'linear-gradient(135deg, #bbdefb, #90caf9)',
                tertiary: 'linear-gradient(135deg, #90caf9, #64b5f6)'
            }
        };
        
        // Enhanced utility function to generate colors for charts
        function getChartColors(count, type = 'chart') {
            const colors = [];
            const palette = type === 'viz' ? CVE_COLORS.vizColors : CVE_COLORS.chartColors;
            
            for (let i = 0; i < count; i++) {
                colors.push(palette[i % palette.length]);
            }
            return colors;
        }
        
        // Generate light blue to grey gradient colors
        function getGradientColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                const ratio = i / Math.max(count - 1, 1);
                // Interpolate between light blue and grey
                const r = Math.round(227 + (158 - 227) * ratio); // e3 to 9e
                const g = Math.round(242 + (158 - 242) * ratio); // f2 to 9e
                const b = Math.round(253 + (158 - 253) * ratio); // fd to 9e
                colors.push(`rgb(${r}, ${g}, ${b})`);
            }
            return colors;
        }
        
        // Get color with opacity
        function getColorWithOpacity(color, opacity = 0.8) {
            if (color.startsWith('#')) {
                const r = parseInt(color.slice(1, 3), 16);
                const g = parseInt(color.slice(3, 5), 16);
                const b = parseInt(color.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${opacity})`;
            }
            return color;
        }
        
        // Utility function to format numbers
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }
        
        // Utility function to show loading state
        function showLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = '<div class="loading"><div class="spinner"></div>Loading data...</div>';
            }
        }
        
        // Utility function to hide loading state
        function hideLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                const loading = container.querySelector('.loading');
                if (loading) {
                    loading.remove();
                }
            }
        }
        
        // Get current year for dynamic functionality
        const CURRENT_YEAR = new Date().getFullYear();
        const AVAILABLE_YEARS = [];
        for (let year = 1999; year <= CURRENT_YEAR; year++) {
            AVAILABLE_YEARS.push(year);
        }
    </script>
    
    
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Wait for Chart.js and CVE_COLORS to be available
    if (typeof Chart === 'undefined' || typeof window.CVE_COLORS === 'undefined') {
        console.error('Chart.js or CVE_COLORS not loaded');
        return;
    }
    
    // Initialize CVEs by Year Chart
    const ctx = document.getElementById('cvesByYearChart');
    if (ctx) {
        // Sample data - this would be populated by the Python backend
        const yearlyData = {
            labels: [],
            datasets: [{
                label: 'CVEs Published',
                data: [],
                borderColor: window.CVE_COLORS.primary,
                backgroundColor: window.CVE_COLORS.primaryLight,
                fill: false,
                tension: 0.1
            }]
        };
        
        // Load actual CVE data from JSON files
        const currentYear = new Date().getFullYear();
        const loadPromises = [];
        
        // Generate years from 1999 to current year and load data
        for (let year = 1999; year <= currentYear; year++) {
            yearlyData.labels.push(year.toString());
            
            // Load actual CVE data for each year
            const promise = fetch(`data/cve_${year}.json`)
                .then(response => {
                    if (!response.ok) {
                        console.warn(`No data found for year ${year}`);
                        return { total_cves: 0 };
                    }
                    return response.json();
                })
                .then(data => {
                    return { year: year, count: data.total_cves || 0 };
                })
                .catch(error => {
                    console.warn(`Error loading data for year ${year}:`, error);
                    return { year: year, count: 0 };
                });
            
            loadPromises.push(promise);
        }
        
        // Wait for all data to load, then create the chart and update stats
        Promise.all(loadPromises).then(results => {
            // Sort results by year to ensure correct order
            results.sort((a, b) => a.year - b.year);
            
            // Extract the CVE counts in the correct order
            yearlyData.datasets[0].data = results.map(result => result.count);
            
            // Calculate and update statistics
            updateStatistics(results);
            
            // Create the chart with real data
            createChart();
        }).catch(error => {
            console.error('Error loading CVE data:', error);
            // Fallback: create chart with empty data and show error in stats
            updateStatisticsError();
            createChart();
        });
        
        function updateStatistics(results) {
            try {
                // Calculate total CVEs
                const totalCves = results.reduce((sum, result) => sum + result.count, 0);
                document.getElementById('total-cves').textContent = totalCves.toLocaleString();
                
                // Calculate CVEs this year (current year)
                const currentYear = new Date().getFullYear();
                const currentYearData = results.find(r => r.year === currentYear);
                const cvesThisYear = currentYearData ? currentYearData.count : 0;
                document.getElementById('cves-this-year').textContent = cvesThisYear.toLocaleString();
                
                // Calculate average CVEs per day (based on current year)
                const dayOfYear = Math.floor((new Date() - new Date(currentYear, 0, 0)) / (1000 * 60 * 60 * 24));
                const avgCvesPerDay = cvesThisYear > 0 && dayOfYear > 0 ? (cvesThisYear / dayOfYear).toFixed(1) : '0';
                document.getElementById('avg-cves-per-day').textContent = avgCvesPerDay;
                
                // Calculate YTD growth rate (current year YTD vs same period last year)
                const prevYearData = results.find(r => r.year === currentYear - 1);
                const prevYearCount = prevYearData ? prevYearData.count : 0;
                
                if (prevYearCount > 0) {
                    // Calculate same period last year (YTD comparison)
                    const dayOfYear = Math.floor((new Date() - new Date(currentYear, 0, 0)) / (1000 * 60 * 60 * 24));
                    const yearProgress = dayOfYear / 365; // Approximate year progress
                    const prevYearYtdEstimate = Math.round(prevYearCount * yearProgress);
                    
                    const growthRate = prevYearYtdEstimate > 0 ? ((cvesThisYear - prevYearYtdEstimate) / prevYearYtdEstimate) * 100 : 0;
                    const growthText = growthRate >= 0 ? `+${growthRate.toFixed(1)}%` : `${growthRate.toFixed(1)}%`;
                    document.getElementById('growth-rate').textContent = growthText;
                    document.getElementById('growth-detail').textContent = `${cvesThisYear.toLocaleString()} vs ${prevYearYtdEstimate.toLocaleString()} (YTD vs Same Period ${currentYear - 1})`;
                } else {
                    document.getElementById('growth-rate').textContent = 'N/A';
                    document.getElementById('growth-detail').textContent = 'No previous year data';
                }
            } catch (error) {
                console.error('Error updating statistics:', error);
                updateStatisticsError();
            }
        }
        
        function updateStatisticsError() {
            document.getElementById('total-cves').textContent = 'Error';
            document.getElementById('cves-this-year').textContent = 'Error';
            document.getElementById('avg-cves-per-day').textContent = 'Error';
            document.getElementById('growth-rate').textContent = 'Error';
            document.getElementById('growth-detail').textContent = 'Error loading data';
        }
        
        function createChart() {
            new Chart(ctx, {
                type: 'line',
                data: yearlyData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'CVE Publications by Year',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of CVEs'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    elements: {
                        point: {
                            radius: 4,
                            hoverRadius: 6
                        }
                    }
                }
            });
        }
    }
    
    // Initialize Intelligence Dashboard Preview Charts
    initializePreviewCharts();
});

function initializePreviewCharts() {
    // Growth Intelligence Preview Chart
    const growthPreviewCtx = document.getElementById('growthPreviewChart');
    if (growthPreviewCtx) {
        fetch('data/growth_analysis.json')
            .then(response => response.json())
            .then(data => {
                const growthData = data.growth_data || [];
                const labels = [];
                const growthRates = [];
                
                // Show all years of data (exclude current year as it's YTD)
                const allData = growthData.filter(item => item.year !== new Date().getFullYear());
                allData.forEach(item => {
                    labels.push(item.year.toString());
                    growthRates.push(item.growth_rate || 0);
                });
                
                new Chart(growthPreviewCtx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: growthRates,
                            borderColor: '#6c9bd1',
                            backgroundColor: 'rgba(108, 155, 209, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `Growth: ${context.parsed.y >= 0 ? '+' : ''}${context.parsed.y.toFixed(1)}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Growth Rate (%)'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            },
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Year'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            }
                        },
                        elements: {
                            point: { radius: 2 }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading growth preview data:', error);
                growthPreviewCtx.parentElement.innerHTML = '<div class="text-center text-muted py-4"><small>Preview unavailable</small></div>';
            });
    }
    
    // CVSS Intelligence Preview Chart
    const cvssPreviewCtx = document.getElementById('cvssPreviewChart');
    if (cvssPreviewCtx) {
        fetch('data/cvss_analysis.json')
            .then(response => response.json())
            .then(data => {
                // Aggregate severity data across all CVSS versions
                const aggregatedSeverity = {};
                const severityDistribution = data.severity_distribution || {};
                
                Object.values(severityDistribution).forEach(versionData => {
                    Object.entries(versionData).forEach(([severity, count]) => {
                        aggregatedSeverity[severity] = (aggregatedSeverity[severity] || 0) + count;
                    });
                });
                
                const labels = Object.keys(aggregatedSeverity);
                const values = Object.values(aggregatedSeverity);
                
                new Chart(cvssPreviewCtx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: '#6c9bd1',
                            borderColor: '#5a8bc4',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CVE Count'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            },
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Severity Level'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading CVSS preview data:', error);
                cvssPreviewCtx.parentElement.innerHTML = '<div class="text-center text-muted py-4"><small>Preview unavailable</small></div>';
            });
    }
    
    // CWE Intelligence Preview Chart
    const cwePreviewCtx = document.getElementById('cwePreviewChart');
    if (cwePreviewCtx) {
        fetch('data/cwe_analysis.json')
            .then(response => response.json())
            .then(data => {
                const cweData = data.top_cwes || [];
                const topCWEs = cweData.slice(0, 5); // Top 5 CWEs
                const labels = topCWEs.map(item => `CWE-${item.id}`);
                const values = topCWEs.map(item => item.count);
                
                new Chart(cwePreviewCtx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: '#6c9bd1',
                            borderColor: '#5a8bc4',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CVE Count'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            },
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CWE Type'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading CWE preview data:', error);
                cwePreviewCtx.parentElement.innerHTML = '<div class="text-center text-muted py-4"><small>Preview unavailable</small></div>';
            });
    }
    
    // CNA Intelligence Preview Chart
    const cnaPreviewCtx = document.getElementById('cnaPreviewChart');
    if (cnaPreviewCtx) {
        fetch('data/cna_analysis.json')
            .then(response => response.json())
            .then(data => {
                const cnaData = data.cna_assigners || [];
                const topCNAs = cnaData.slice(0, 5); // Top 5 CNAs
                const labels = topCNAs.map(item => item.name.length > 15 ? item.name.substring(0, 15) + '...' : item.name);
                const values = topCNAs.map(item => item.count);
                
                new Chart(cnaPreviewCtx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: '#6c9bd1',
                            borderColor: '#5a8bc4',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CNA Organization'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            },
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CVE Count'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading CNA preview data:', error);
                cnaPreviewCtx.parentElement.innerHTML = '<div class="text-center text-muted py-4"><small>Preview unavailable</small></div>';
            });
    }
    
    // CPE Intelligence Preview Chart
    const cpePreviewCtx = document.getElementById('cpePreviewChart');
    if (cpePreviewCtx) {
        fetch('data/cpe_analysis.json')
            .then(response => response.json())
            .then(data => {
                const cpeData = data.top_cpes || [];
                const topCPEs = cpeData.slice(0, 5); // Top 5 CPEs
                const labels = topCPEs.map(item => item.vendor.length > 12 ? item.vendor.substring(0, 12) + '...' : item.vendor);
                const values = topCPEs.map(item => item.count);
                
                new Chart(cpePreviewCtx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: '#6c9bd1',
                            borderColor: '#5a8bc4',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'CVE Count'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            },
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Vendor'
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading CPE preview data:', error);
                cpePreviewCtx.parentElement.innerHTML = '<div class="text-center text-muted py-4"><small>Preview unavailable</small></div>';
            });
    }
}
</script>

</body>
</html>